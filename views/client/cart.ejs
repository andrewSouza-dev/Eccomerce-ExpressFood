<%- include('../partials/menu') %>

<h2>Seu carrinho</h2>

<% let total = 0 %>
<ul>
  <% cart.forEach(item => { 
       const subtotal = item.product.price * item.quantity
       total += subtotal
  %>
    <li>
      <strong><%= item.product.name %></strong> - R$ <%= item.product.price %> x <%= item.quantity %>
      = R$ <%= subtotal.toFixed(2) %>
      <form action="/cart/remover" method="POST" style="display:inline;">
        <input type="hidden" name="productId" value="<%= item.product.id %>" />
        <button type="submit">Remover</button>
      </form>
    </li>
  <% }) %>
</ul>

<h3>Total: R$ <%= total.toFixed(2) %></h3>

<form action="/orders/finalizar" method="POST">
  <button type="submit">Finalizar compra</button>
</form>

<%- include('../partials/footer') %>
